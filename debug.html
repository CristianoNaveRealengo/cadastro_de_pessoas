<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug - Sistema de Cadastro</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-2xl mx-auto bg-white rounded-lg shadow-md p-6">
        <h1 class="text-2xl font-bold text-gray-800 mb-4">🔍 Debug do Sistema</h1>
        
        <div id="debugInfo" class="space-y-4">
            <div class="p-4 bg-blue-50 rounded-lg">
                <h3 class="font-semibold text-blue-800">Status dos Scripts:</h3>
                <div id="scriptStatus" class="mt-2 space-y-1"></div>
            </div>
            
            <div class="p-4 bg-green-50 rounded-lg">
                <h3 class="font-semibold text-green-800">Variáveis Globais:</h3>
                <div id="globalVars" class="mt-2 space-y-1"></div>
            </div>
            
            <div class="p-4 bg-yellow-50 rounded-lg">
                <h3 class="font-semibold text-yellow-800">Erros Encontrados:</h3>
                <div id="errors" class="mt-2 space-y-1"></div>
            </div>
        </div>
        
        <div class="mt-6">
            <button onclick="runDebug()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
                🔄 Executar Debug
            </button>
            <a href="index.html" class="ml-4 bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 inline-block">
                🏠 Voltar ao Sistema
            </a>
        </div>
    </div>

    <script>
        let errors = [];
        
        // Capturar erros JavaScript
        window.onerror = function(message, source, lineno, colno, error) {
            errors.push({
                message: message,
                source: source,
                line: lineno,
                column: colno,
                error: error
            });
            return false;
        };

        function runDebug() {
            const scriptStatus = document.getElementById('scriptStatus');
            const globalVars = document.getElementById('globalVars');
            const errorsDiv = document.getElementById('errors');
            
            // Verificar scripts
            const scripts = [
                'appData',
                'firebaseService', 
                'ValidationUtils',
                'FormatUtils',
                'DataUtils',
                'UIUtils',
                'StorageUtils',
                'AdvancedStats',
                'AdvancedSearch',
                'AdvancedExport',
                'backupManager'
            ];
            
            scriptStatus.innerHTML = '';
            scripts.forEach(script => {
                const exists = typeof window[script] !== 'undefined';
                const status = exists ? '✅' : '❌';
                const color = exists ? 'text-green-600' : 'text-red-600';
                scriptStatus.innerHTML += `<div class="${color}">${status} ${script}</div>`;
            });
            
            // Verificar variáveis globais
            globalVars.innerHTML = '';
            const globals = Object.keys(window).filter(key => 
                key.startsWith('app') || 
                key.startsWith('firebase') || 
                key.includes('Utils') ||
                key.includes('Advanced') ||
                key.includes('Manager')
            );
            
            globals.forEach(global => {
                globalVars.innerHTML += `<div class="text-blue-600">🔹 ${global}</div>`;
            });
            
            // Mostrar erros
            errorsDiv.innerHTML = '';
            if (errors.length === 0) {
                errorsDiv.innerHTML = '<div class="text-green-600">✅ Nenhum erro encontrado!</div>';
            } else {
                errors.forEach(error => {
                    errorsDiv.innerHTML += `
                        <div class="text-red-600 text-sm">
                            ❌ ${error.message}<br>
                            📁 ${error.source}:${error.line}:${error.column}
                        </div>
                    `;
                });
            }
        }
        
        // Executar debug automaticamente
        setTimeout(runDebug, 1000);
    </script>
    
    <!-- Carregar scripts do sistema para teste -->
    <script src="script.js"></script>
    <script src="utils.js"></script>
    <script src="enhancements.js"></script>
    <script src="dev-config.js"></script>
</body>
</html>